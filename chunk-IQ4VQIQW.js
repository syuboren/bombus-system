import{a as Q}from"./chunk-PABKVVOZ.js";import{a as D}from"./chunk-PZOMZZZC.js";import{i as V,j as $,l as G}from"./chunk-6NWKX4EL.js";import{a as H}from"./chunk-ZVKGYAYE.js";import"./chunk-TKFFVAKG.js";import{$ as c,Ba as L,G as l,L as f,P as m,Q as M,R as w,W as N,X as b,Y as h,Z as o,_ as r,aa as T,ba as x,ca as P,fa as B,ga as S,ha as k,ia as a,ja as d,ka as _,n as O,o as C,qa as I,sa as y,t as u,ta as z,u as g,za as R}from"./chunk-Y7UTIMVI.js";import{a as F,b as A}from"./chunk-GAL4ENT6.js";var K=["distributionChart"],U=["scatterChart"],Y=(s,t)=>t.value,J=(s,t)=>t.id;function X(s,t){if(s&1&&(o(0,"option",11),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),d(e.label)}}function Z(s,t){if(s&1&&(o(0,"option",11),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),d(e.label)}}function ee(s,t){if(s&1&&(o(0,"div",35)(1,"div",36),a(2),r(),o(3,"div",37)(4,"span",38),a(5),r(),o(6,"span",39),a(7),r()(),o(8,"div",40)(9,"span",41),a(10),r(),o(11,"span",42),a(12),r()()()),s&2){let e=t.$implicit,n=P(2);w("draggable",n.simulationMode()),l(2),d(e.name.charAt(0)),l(3),d(e.name),l(2),d(e.department),l(3),_("P",e.performance,""),l(2),_("\u6F5B",e.potential,"")}}function te(s,t){if(s&1&&(I(0)(1),o(2,"div",28)(3,"div",29)(4,"span",30),a(5),r(),o(6,"span",31),a(7),r()(),o(8,"div",32),a(9),r(),o(10,"div",33),b(11,ee,13,7,"div",34,J),r()()),s&2){let e=t.$implicit,n=P(),i=n.getCategoryInfo(e),p=n.employeesByCategory()[e];l(2),M("background",i.bgGradient)("border-color",i.color),l(3),d(i.title),l(2),d(i.subtitle),l(),M("color",i.color),l(),_(" ",p.length," \u4EBA "),l(2),h(p)}}var v=class s{distributionChartRef;scatterChartRef;talentMapService=O(Q);cdr=O(R);distributionChart=null;scatterChart=null;viewReady=!1;resizeHandler=()=>{this.distributionChart?.resize(),this.scatterChart?.resize()};departmentOptions=[{value:"all",label:"\u6240\u6709\u90E8\u9580"},{value:"rd",label:"\u7814\u767C\u90E8"},{value:"hr",label:"\u4EBA\u8CC7\u90E8"},{value:"sales",label:"\u696D\u52D9\u90E8"},{value:"marketing",label:"\u884C\u92B7\u90E8"}];levelOptions=this.talentMapService.levelOptions;categories=this.talentMapService.nineBoxCategories;filter=f({department:"all",level:"all"});employees=f([]);loading=f(!1);simulationMode=f(!1);employeesByCategory=L(()=>{let t=this.employees(),e={star:[],potential:[],develop:[],specialist:[],stable:[],risk:[],expert:[],"need-improve":[],exit:[]};return t.forEach(n=>e[n.category].push(n)),e});gridOrder=["develop","potential","star","risk","stable","specialist","exit","need-improve","expert"];ngOnInit(){window.addEventListener("resize",this.resizeHandler)}ngAfterViewInit(){this.viewReady=!0,this.loadData()}ngOnDestroy(){window.removeEventListener("resize",this.resizeHandler),this.distributionChart?.dispose(),this.scatterChart?.dispose()}loadData(){this.loading.set(!0),this.talentMapService.getNineBoxEmployees(this.filter()).subscribe({next:t=>{this.employees.set(t),this.loading.set(!1),this.cdr.detectChanges(),this.viewReady&&t.length>0&&setTimeout(()=>this.updateCharts(t),100)}})}updateFilter(t,e){this.filter.update(n=>A(F({},n),{[t]:e})),this.loadData()}toggleSimulationMode(){this.simulationMode.update(t=>!t)}getCategoryInfo(t){return this.categories.find(e=>e.key===t)}getEmployeeCount(t){return this.employeesByCategory()[t].length}exportChart(t){let e=t==="distribution"?this.distributionChart:this.scatterChart;if(e){let n=e.getDataURL({type:"png",pixelRatio:2}),i=document.createElement("a");i.download=`${t}-chart.png`,i.href=n,i.click()}}updateCharts(t){this.updateDistributionChart(t),this.updateScatterChart(t)}updateDistributionChart(t){if(!this.distributionChartRef?.nativeElement)return;this.distributionChart||(this.distributionChart=D(this.distributionChartRef.nativeElement));let e=this.employeesByCategory(),n=this.categories.map(p=>({name:p.title.replace("\u2B50 ",""),value:e[p.key].length,itemStyle:{color:p.color}})).filter(p=>p.value>0),i={tooltip:{trigger:"item",formatter:"{b}: {c} \u4EBA ({d}%)"},legend:{orient:"vertical",right:"5%",top:"center",textStyle:{color:"#6B7280"}},series:[{type:"pie",radius:["40%","70%"],center:["35%","50%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"}},data:n}]};this.distributionChart.setOption(i)}updateScatterChart(t){if(!this.scatterChartRef?.nativeElement)return;this.scatterChart||(this.scatterChart=D(this.scatterChartRef.nativeElement));let e=t.map(i=>{let p=this.getCategoryInfo(i.category);return{name:i.name,value:[i.performance,i.potential],itemStyle:{color:p.color}}}),n={tooltip:{formatter:i=>{let p=i;return`${p.name}<br/>\u7E3E\u6548: ${p.value[0]}<br/>\u6F5B\u529B: ${p.value[1]}`}},grid:{left:"10%",right:"10%",top:"10%",bottom:"15%"},xAxis:{type:"value",name:"\u7E3E\u6548\u8868\u73FE",nameLocation:"middle",nameGap:30,min:0,max:100,splitLine:{lineStyle:{color:"#E8E8EA"}},axisLabel:{color:"#6B7280"}},yAxis:{type:"value",name:"\u767C\u5C55\u6F5B\u529B",nameLocation:"middle",nameGap:40,min:0,max:100,splitLine:{lineStyle:{color:"#E8E8EA"}},axisLabel:{color:"#6B7280"}},series:[{type:"scatter",symbolSize:15,data:e,emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"}}}],markLine:{silent:!0,lineStyle:{color:"#E8E8EA",type:"dashed"},data:[{xAxis:33},{xAxis:66},{yAxis:33},{yAxis:66}]}};this.scatterChart.setOption(n)}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=C({type:s,selectors:[["app-nine-box-tab"]],viewQuery:function(e,n){if(e&1&&(B(K,5),B(U,5)),e&2){let i;S(i=k())&&(n.distributionChartRef=i.first),S(i=k())&&(n.scatterChartRef=i.first)}},standalone:!0,features:[y],decls:47,vars:4,consts:[["distributionChart",""],["scatterChart",""],[1,"map-card"],[1,"map-card__header"],[1,"map-card__title"],[1,"ri-grid-fill"],[1,"map-card__desc"],[1,"filters"],[1,"filter-group"],["for","nineBoxDept"],["id","nineBoxDept",3,"change","value"],[3,"value"],["for","nineBoxLevel"],["id","nineBoxLevel",3,"change","value"],["type","button",1,"simulation-btn",3,"click"],[1,"ri-drag-drop-line"],[1,"nine-box-wrapper"],[1,"axis-label","axis-label--y"],[1,"axis-label","axis-label--x"],[1,"nine-box-grid"],[1,"box-cell",3,"background","border-color"],[1,"charts-section"],[1,"section-title"],[1,"chart-combo"],[1,"chart-card"],[1,"chart-container"],["type","button",1,"export-btn",3,"click"],[1,"ri-download-2-line"],[1,"box-cell"],[1,"box-cell__header"],[1,"box-cell__title"],[1,"box-cell__subtitle"],[1,"box-cell__count"],[1,"employee-list"],[1,"employee-card",3,"draggable"],[1,"employee-card"],[1,"employee-avatar"],[1,"employee-info"],[1,"employee-name"],[1,"employee-dept"],[1,"employee-scores"],[1,"score-badge","score-badge--performance"],[1,"score-badge","score-badge--potential"]],template:function(e,n){if(e&1){let i=T();o(0,"div",2)(1,"header",3)(2,"h2",4),c(3,"i",5),a(4," \u4EBA\u624D\u4E5D\u5BAE\u683C (Talent 9-Box Grid) "),r(),o(5,"p",6),a(6," \u5E74\u5EA6\u4EBA\u624D\u76E4\u9EDE\u3001\u6649\u5347\u6C7A\u7B56\u3001\u63A5\u73ED\u4EBA\u898F\u5283\u7684\u5229\u5668\u3002\u652F\u63F4\u62D6\u66F3\u54E1\u5DE5\u982D\u50CF\u9032\u884C\u60C5\u5883\u6A21\u64EC\u3002 "),r()(),o(7,"div",7)(8,"div",8)(9,"label",9),a(10,"\u90E8\u9580\u7BE9\u9078:"),r(),o(11,"select",10),x("change",function(E){return u(i),g(n.updateFilter("department",E.target.value))}),b(12,X,2,2,"option",11,Y),r()(),o(14,"div",8)(15,"label",12),a(16,"\u8077\u7D1A\u7BE9\u9078:"),r(),o(17,"select",13),x("change",function(E){return u(i),g(n.updateFilter("level",E.target.value))}),b(18,Z,2,2,"option",11,Y),r()(),o(20,"button",14),x("click",function(){return u(i),g(n.toggleSimulationMode())}),c(21,"i",15),a(22," \u60C5\u5883\u6A21\u64EC\u6A21\u5F0F "),r()(),o(23,"div",16)(24,"div",17),a(25," \u767C\u5C55\u6F5B\u529B (Potential) \u2192 "),r(),o(26,"div",18),a(27," \u7E3E\u6548\u8868\u73FE (Performance) \u2192 "),r(),o(28,"div",19),b(29,te,13,9,"div",20,N),r()(),o(31,"section",21)(32,"h3",22),a(33,"\u4EBA\u624D\u5206\u4F48\u7D71\u8A08"),r(),o(34,"div",23)(35,"div",24),c(36,"div",25,0),o(38,"button",26),x("click",function(){return u(i),g(n.exportChart("distribution"))}),c(39,"i",27),a(40," \u532F\u51FA\u5713\u9905\u5716 PNG "),r()(),o(41,"div",24),c(42,"div",25,1),o(44,"button",26),x("click",function(){return u(i),g(n.exportChart("scatter"))}),c(45,"i",27),a(46," \u532F\u51FA\u6563\u4F48\u5716 PNG "),r()()()()()}e&2&&(l(11),m("value",n.filter().department),l(),h(n.departmentOptions),l(5),m("value",n.filter().level),l(),h(n.levelOptions),l(2),w("active",n.simulationMode()),l(9),h(n.gridOrder))},dependencies:[G,V,$],styles:[".map-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #E2E4E8;padding:30px}.map-card__header[_ngcontent-%COMP%]{margin-bottom:25px}.map-card__title[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#1f2937;margin-bottom:8px;display:flex;align-items:center;gap:10px}.map-card__title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#7f9ca0}.map-card__desc[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;line-height:1.6}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px;align-items:center;margin-bottom:25px;padding:20px;background:#f5f5f7;border-radius:10px}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1f2937;white-space:nowrap}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px 15px;border:1px solid #E2E4E8;border-radius:8px;background:#fff;color:#1f2937;font-size:14px;cursor:pointer;transition:all .3s ease;min-width:150px}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{border-color:#64748b}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#64748b;box-shadow:0 0 0 3px #64748b1a}.simulation-btn[_ngcontent-%COMP%]{margin-left:auto;padding:10px 15px;background:#fff;border:1px solid #E2E4E8;border-radius:8px;font-size:14px;font-weight:600;color:#1f2937;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.simulation-btn[_ngcontent-%COMP%]:hover{border-color:#64748b;color:#64748b}.simulation-btn.active[_ngcontent-%COMP%]{background:#64748b;border-color:#64748b;color:#fff}.nine-box-wrapper[_ngcontent-%COMP%]{position:relative;margin:30px 0 50px 75px}.axis-label[_ngcontent-%COMP%]{font-weight:700;color:#1f2937;font-size:14px;white-space:nowrap}.axis-label--y[_ngcontent-%COMP%]{position:absolute;left:-95px;top:50%;transform:translateY(-50%) rotate(-90deg)}.axis-label--x[_ngcontent-%COMP%]{text-align:center;margin-bottom:15px}.nine-box-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px}.box-cell[_ngcontent-%COMP%]{border:2px solid;border-radius:12px;padding:20px;min-height:200px}.box-cell__header[_ngcontent-%COMP%]{margin-bottom:8px}.box-cell__title[_ngcontent-%COMP%]{display:block;font-weight:700;color:#1f2937;margin-bottom:4px;font-size:15px}.box-cell__subtitle[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280}.box-cell__count[_ngcontent-%COMP%]{font-size:32px;font-weight:800;margin-bottom:15px;letter-spacing:-1px}.employee-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.employee-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:10px;display:flex;align-items:center;gap:10px;border:1px solid #E2E4E8;transition:all .3s ease}.employee-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 2px 8px #00000014}.employee-card.draggable[_ngcontent-%COMP%]{cursor:move}.employee-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#64748b;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;flex-shrink:0}.employee-info[_ngcontent-%COMP%]{flex:1;min-width:0}.employee-name[_ngcontent-%COMP%]{display:block;font-weight:600;color:#1f2937;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.employee-dept[_ngcontent-%COMP%]{display:block;font-size:11px;color:#6b7280}.employee-scores[_ngcontent-%COMP%]{display:flex;gap:8px;font-size:11px}.score-badge[_ngcontent-%COMP%]{padding:2px 6px;border-radius:4px;font-weight:600}.score-badge--performance[_ngcontent-%COMP%]{background:#7f9ca033;color:#7f9ca0}.score-badge--potential[_ngcontent-%COMP%]{background:#8da39933;color:#8da399}.charts-section[_ngcontent-%COMP%]{margin-top:30px}.section-title[_ngcontent-%COMP%]{color:#1f2937;margin-bottom:20px;font-size:18px}.chart-combo[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}.chart-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;border:1px solid #E2E4E8}.chart-container[_ngcontent-%COMP%]{width:100%;height:400px;margin-bottom:15px}.export-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#64748b;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;gap:8px}.export-btn[_ngcontent-%COMP%]:hover{background:#475569;transform:translateY(-2px);box-shadow:0 4px 15px #0000001a}.export-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 1400px){.chart-combo[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.nine-box-wrapper[_ngcontent-%COMP%]{margin-left:0}.axis-label--y[_ngcontent-%COMP%]{display:none}.nine-box-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.filters[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.simulation-btn[_ngcontent-%COMP%]{margin-left:0;width:100%;justify-content:center}}"],changeDetection:0})};var ne=()=>["\u6559\u80B2\u8A13\u7DF4","\u4EBA\u624D\u4E5D\u5BAE\u683C"],j=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=C({type:s,selectors:[["app-nine-box-page"]],standalone:!0,features:[y],decls:4,vars:2,consts:[["pageTitle","\u4EBA\u624D\u4E5D\u5BAE\u683C",3,"breadcrumbs"],[1,"main-content"],[1,"content-container"]],template:function(e,n){e&1&&(c(0,"app-header",0),o(1,"main",1)(2,"div",2),c(3,"app-nine-box-tab"),r()()),e&2&&m("breadcrumbs",z(1,ne))},dependencies:[H,v],styles:["[_ngcontent-%COMP%]:root{--color-cloud-gray: #F5F5F7;--color-pure-white: #FCFCFD;--color-soft-gray: #E8E8EA;--color-text-primary: #464E56;--color-text-secondary: #6B7280;--color-text-dark: #1F2937;--color-brand-main: #64748B;--color-brand-light: #94A3B8;--color-brand-dark: #475569;--color-l1-sage: #8DA399;--color-l2-terracotta: #D6A28C;--color-l3-petrol: #7F9CA0;--color-l4-mauve: #9A8C98;--color-l5-brick: #B87D7B;--color-l6-rose: #C4A4A1;--color-success: #7FB095;--color-warning: #E3C088;--color-error: #C77F7F;--color-info: #8DA8BE;--sidebar-width: 280px;--sidebar-width-minimized: 80px;--header-height: 70px;--radius-sm: 6px;--radius-md: 8px;--radius-lg: 12px;--shadow-soft: 0 4px 20px rgba(0, 0, 0, .05);--shadow-md: 0 4px 12px rgba(0, 0, 0, .06);--shadow-lg: 0 8px 24px rgba(0, 0, 0, .08);--transition-normal: .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideInLeft{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}.main-content[_ngcontent-%COMP%]{padding:1.5rem;margin-top:70px}@media (max-width: 767px){.main-content[_ngcontent-%COMP%]{padding:1rem}}.content-container[_ngcontent-%COMP%]{max-width:1600px;margin:0 auto}"],changeDetection:0})};export{j as NineBoxPageComponent};
