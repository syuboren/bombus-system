<header class="header">
  <div class="header__container">
    <!-- Mobile Toggle -->
    <button
      class="header__mobile-toggle"
      (click)="toggleMobileSidebar()"
      type="button"
      aria-label="Toggle sidebar">
      <i class="ri-menu-line"></i>
    </button>

    <!-- Page Title & Breadcrumb -->
    <div class="header__title-section">
      <h1 class="header__title">{{ pageTitle() }}</h1>
      <nav class="header__breadcrumb" aria-label="Breadcrumb">
        @for (crumb of breadcrumbs(); track crumb; let last = $last) {
          <span class="breadcrumb-item" [class.active]="last">{{ crumb }}</span>
          @if (!last) {
            <i class="ri-arrow-right-s-line breadcrumb-separator"></i>
          }
        }
        <i class="ri-arrow-right-s-line breadcrumb-separator"></i>
        <span class="breadcrumb-item active">{{ pageTitle() }}</span>
      </nav>
    </div>

    <!-- Page Actions (from parent component) -->
    <div class="header__page-actions">
      <ng-content></ng-content>
    </div>

    <!-- Header Actions -->
    <div class="header__actions">
      <!-- Search -->
      <button
        class="header__action-btn"
        (click)="onSearch()"
        type="button"
        aria-label="Search">
        <i class="ri-search-line"></i>
      </button>

      <!-- Notifications -->
      <button
        class="header__action-btn header__action-btn--notification"
        (click)="onNotification()"
        type="button"
        aria-label="Notifications">
        <i class="ri-notification-3-line"></i>
        <span class="notification-badge">5</span>
      </button>

      <!-- Quick Actions -->
      <button
        class="header__action-btn"
        (click)="onQuickAction()"
        type="button"
        aria-label="Quick actions">
        <i class="ri-add-circle-line"></i>
      </button>

      <!-- User Menu -->
      <div class="header__user-menu-wrapper">
        <button
          class="header__action-btn header__action-btn--user"
          (click)="toggleUserMenu()"
          type="button"
          aria-label="User menu"
          [attr.aria-expanded]="showUserMenu()">
          <span class="user-avatar">{{ getUserInitial() }}</span>
          <i class="ri-arrow-down-s-line user-arrow" [class.rotated]="showUserMenu()"></i>
        </button>

        <!-- Dropdown Menu -->
        @if (showUserMenu()) {
          <div class="user-dropdown">
            <div class="user-dropdown__header">
              <div class="user-dropdown__avatar">{{ getUserInitial() }}</div>
              <div class="user-dropdown__info">
                <span class="user-dropdown__name">{{ currentUser()?.name || '使用者' }}</span>
                <span class="user-dropdown__email">{{ currentUser()?.email || '' }}</span>
              </div>
            </div>
            <div class="user-dropdown__divider"></div>
            <div class="user-dropdown__menu">
              <button class="user-dropdown__item" type="button">
                <i class="ri-user-line"></i>
                <span>個人資料</span>
              </button>
              <button class="user-dropdown__item" type="button">
                <i class="ri-settings-3-line"></i>
                <span>帳號設定</span>
              </button>
            </div>
            <div class="user-dropdown__divider"></div>
            <div class="user-dropdown__menu">
              <button class="user-dropdown__item user-dropdown__item--danger" type="button" (click)="onLogout()">
                <i class="ri-logout-box-r-line"></i>
                <span>登出系統</span>
              </button>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</header>

